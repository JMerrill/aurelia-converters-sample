<template>
  <div class.bind="iframe ? 'container-fluid ghost' : 'container'">
    <markdown>
      # Aurelia Value Converters
      An overview of the [Aurelia](http://aurelia.io) framework's value
      converter functionality.

      This page is written using Aurelia and contains live examples.  The full
      source is [here](https://github.com/jdanyow/aurelia-converters-sample).

      ## Introduction to Data Binding

      A short description of data-binding from the Aurelia
      [docs](http://aurelia.io/docs.html):

      *In Aurelia, user interface elements are composed of view and view-model
      pairs. The view is written with HTML and is rendered into the DOM. The
      view-model is written with JavaScript and provides data and behavior to
      the view.  Aurelia's powerful databinding links the two pieces together
      allowing changes in your data to be reflected in the view and vice versa.*

      Check out the getting started video
      [here](http://aurelia.io/) or the docs [here](http://aurelia.io/docs.html)
      for more information.

      ### Simple Binding Example

      Here's a simple data-binding example using the **bind** (`.bind="expression"`)
      and **interpolation** (`${expression}`) techniques:
    </markdown>

    <sample src="samples/1"></sample>

    <markdown>
      ### Binding Dates and Numbers

      Sometimes the raw data exposed by your view-model isn't in a format that's
      ideal for displaying in the UI.  Rendering date and numeric values are
      common scenarios:
    </markdown>

    <sample src="samples/2"></sample>

    <markdown>
      Ideally the date would be in a more readable format and the amount would
      be formatted as currency.  One solution to this problem would be to compute
      the formatted values and expose them as properties of the view-model.  This
      is certainly a valid approach however defining extra properties and methods
      in your models can get messy, especially when you need to keep the formatted
      values in sync when the original property values change.  Fortunately
      Aurelia has a feature that makes solving this problem quite easy...

      ## Value Converters

      > A value converter is a class whose responsibility is to convert
      view-model* values into values that are appropriate to bind to a view
      *and visa-versa*.

      Most commonly you'll be creating value converters that translate model data
      to a format suitable for the view however there are situations where you'll
      need to convert data from the view to a format expected by the view-model,
      typically when using two-way binding with input elements.

      If you've used value converters in other languages such as WPF/Silverlight
      you'll find Aurelia value converters are quite similar although with a few
      notable improvements:

      1. The Aurelia ValueConverter interface uses `toView` and `fromView` methods
        which make it quite clear which direction the data is flowing.  This is in
        contrast to WPF's `IValueConverter` which uses `Convert` and `ConvertBack`.
      2. In Aurelia, converter parameter's can be data-bound.  This is something
        that was missing in Silverlight and enables more advanced binding scenarios.
      3. Aurelia value converter methods can accept multiple parameters.
      4. Multiple value converters can be composed using pipes (`|`).

      ## Simple Converters

      Before we get too far into the details, let's rework the previous example
      to use a couple of basic value converters.  Aurelia and the popular
      [Moment](http://momentjs.com/) and [Numeral](http://numeraljs.com/) libraries
      will take care of the heavy lifting, we just need to wire things up...
    </markdown>

    <sample src="samples/3" resources.bind="['date-format', 'currency-format']"></sample>

    <markdown>
      OK, the result looks much better but how did this all work?

      Well first we created a couple of value converters:  `DateFormatValueConverter`
      and `CurrencyFormatValueConverter`.  Each has a `toView` method that the Aurelia
      framework will apply to model values before displaying them in the view.
      Our converters use the MomentJS and NumeralJS libraries to format the data.

      Next we updated the view to `import` the converters so they can be used in
      the view.  When importing a resource such as a value converter you supply
      the path to the resource to the import element's `from` attribute.
    </markdown>

    <markdown value="
      ``` markup
      <import from=&quot;./date-format&quot;></import>
      <import from=&quot;./currency-format&quot;></import>
      ```">
    </markdown>

    <markdown>
      When Aurelia processes the resource it examines the class's metadata to
      determine the resource type (custom element, behavior, value converter, etc).
      Metadata isn't required and in fact our value converters didn't expose any.
      Instead we relied on one of Aurelia's simple conventions:  class names ending
      with *ValueConverter* are assumed to be value converters.  The convention
      registers the converter using the class name, camel-cased, with the *ValueConverter*
      portion stripped from the end.

      * `DateFormatValueConverter` registers as `dateFormat`
      * `NumberFormatValueConverter` registers as `numberFormat`

      Finally we applied the converter in the binding using the pipe `|` syntax:

      ``` markup
      ${currentDate | dateFormat} <br/>
      ${netWorth | currencyFormat}
      ```

      ## Converter Parameters

      The converters in the previous example worked great but what if we needed
      to display dates and numbers in multiple formats.  It would be quite repetitive
      to define a converter for each format we needed to display.  A better approach
      would be to modify the converters to accept a `format` parameter.  Then we'd be
      able to specify the format in the binding and get maximum reuse out of our format
      converters.
    </markdown>

    <sample src="samples/4" resources.bind="['date-format', 'number-format']"></sample>

    <markdown>
      With the `format` parameter added to the `toView` methods we are able to
      specify the format in the binding using the `| [converterName]:[parameterExpression]`
      syntax:

      ``` markup
      ${currentDate | dateFormat:'MMMM Mo YYYY'}
      ${netWorth | numberFormat:'$0.0a'}
      ```

      ## Binding Converter Parameters

      Converter parameters needn't be literal values.  You can bind parameter values
      to achieve dynamic results:
    </markdown>

    <sample src="samples/5" resources.bind="['number-format']"></sample>

    <markdown>
      ## Multiple Converter Parameters and Combining Converters

      Value converters can accept multiple parameters and multiple converters
      can be composed in the same binding expression, providing a lot of
      flexibility and opportunity for reuse.

      In the following example we have a view model exposing an array of Aurelia
      repos.  The view uses a repeat binding to list the repos in a table.
      A `SortValueConverter` is used to sort the array based on two arguments:
      `propertyName` and `direction`.  A second converter, `TakeValueConverter`
      accepting a `count` argument is applied to limit the number of repositories
      listed:
    </markdown>

    <markdown value="
      ``` markup
      <tr repeat.for=&quot;repo of repos | sort:column.value:direction.value | take:10&quot;>
      ```">
    </markdown>

    <markdown>
      Here's the full example:
    </markdown>

    <sample src="samples/6" layout="[
      [
        { name: 'view-model', type: 'javascript' },
        { name: 'sort',       type: 'javascript' },
        { name: 'take',       type: 'javascript' }
      ],
      [
        { name: 'view', type: 'markup' }
      ]
    ]"></sample>

    <markdown>
      ## Bi-directional Value Converters
    </markdown>

    <sample src="samples/7"></sample>

    <markdown>
      TODO:

      explain packaging as an internal plugin

      explain packaging as an external plugin

      add ability to copy code samples

      add logic to scroll to url hash

      byeeee
    </markdown>

    <markdown>
      ------------------------------------
      # markdown element tests

      ## anchors

      An [external](http://www.google.com) link.

      An [internal](#markdown-element-tests) link.

      ## inline code

      `inline code`

      ## indented code

      code indent:

          for(var i = 0; i < 3; i++) {

          }

      code indent:

          <div></div>
          <a></a>
          <!-- adsfasfd -->

      ## back-tic code

      js:
      ``` javascript
      for(var i = 0; i < 3; i++) {

      }
      ```

      markup:
      ``` markup
      <div></div>
      <a></a>
      <!-- adsfasfd -->
      ```

      bash:
      ``` bash
      npm install
      jspm install aurelia-framework
      ```

      git:
      ``` git
      git add -A
      git commit -m "saved the day"
      git push
      ```

      css:
      ``` css
      .hidden {
        display: none;
      }
      ```

      ## headings

      ### h3

      #### h4

      ##### h5

      ###### h6

    </markdown>
  </div>
</template>
